%
% Copyright Â© 2017 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

The Lorentz force equation that determines the dynamics of a charged particle in an external field \( F \) has been restated as a multivector differential equation, but how to solve such an equation is probably not obvious.
Given a constant external magnetic field bivector \( F = I c \BB \), the Lorentz force equation, for small velocities\footnote{The (relativistically) correct Lorentz force equation for zero electric field is \( d(m \gamma \Bv)/dt = q F \cdot \Bv/c \) where \( \gamma^{-1} = \sqrt{1 - \Bv^2/c^2}\).  See \citep{doran2003gap} for a relativistic approach to this problem.}, is
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:60}
m \frac{d\Bv}{dt} = q F \cdot \frac{\Bv}{c},
\end{equation}
or
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:80}
\begin{aligned}
\Omega &= -\frac{q F}{m c} \\
\frac{d\Bv}{dt} &= \Bv \cdot \Omega,
\end{aligned}
\end{equation}
where \( \Omega \) is a bivector containing all the constant factors.
%\paragraph{FIXME}: the sign toggle and anticommutation \( \Bv \cdot \Omega = - \Omega \cdot \Bv \) can't be justified yet.  Flip the signs and dot product orders, and rework all of this.

This can be solved by introducing a multivector integration factor \( R \) and its reverse \( R^\dagger \) on the left and right respectively
\begin{dmath}\label{eqn:lorentzForce_constantMagnetic:100}
R \frac{d\Bv}{dt} R^\dagger
= R \Bv \cdot \Omega R^\dagger
= \inv{2} R \lr{ \Bv \Omega - \Omega \Bv} R^\dagger
= \inv{2} R \Bv \Omega R^\dagger - \inv{2} R \Omega \Bv R^\dagger,
\end{dmath}
or
\begin{dmath}\label{eqn:lorentzForce_constantMagnetic:120}
0 =
R \frac{d\Bv}{dt} R^\dagger
+ \inv{2} R \Omega \Bv R^\dagger
- \inv{2} R \Bv \Omega R^\dagger.
\end{dmath}

Let
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:140}
\dot{R} = R \Omega/2.
\end{equation}

Since \( \Omega \) is a bivector \( \dot{R}^\dagger = -\Omega R^\dagger/2 \), so by chain rule
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:160}
0 = \frac{d}{dt} \lr{ R \Bv R^\dagger }.
\end{equation}

The integrating factor has solution
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:180}
R = e^{\Omega t/2},
\end{equation}
a ``complex exponential'', so the solution of \cref{eqn:lorentzForce_constantMagnetic:60} is
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:200}
\Bv(t) = e^{-\Omega t/2} \Bv(0) e^{\Omega t/2}.
\end{equation}

The velocity of the charged particle traces out a helical path.
Any component of the initial velocity \( \Bv(0)_\perp \) perpendicular to the \( \Omega \) plane is untouched by this rotation operation, whereas components of the initial velocity \( \Bv(0)_\parallel \) that lie in the \( \Omega \) plane will trace out a circular path.
If \( \hat{\Omega} \) is the unit bivector for this plane, that velocity is
\begin{equation}\label{eqn:lorentzForce_constantMagnetic:220}
\begin{aligned}
\Bv(0)_\parallel &= \lr{ \Bv(0) \cdot \hat{\Omega} } \hat{\Omega}^{-1}
                  = (\Bv(0) \wedge \Bcap) \cdot \Bcap \\
\Bv(0)_\perp &= \lr{ \Bv(0) \wedge \hat{\Omega} } \hat{\Omega}^{-1}
              = (\Bv(0) \cdot \Bcap) \Bcap \\
\Bv(t) &=
\Bv(0)_\parallel e^{\Omega t} + \Bv(0)_\perp \\
       &=
\Bv(0)_\parallel \cos( q B t/ m )
+
\Bv(0)_\parallel \cross \Bcap \sin( q B t/ m )
+ \Bv(0)_\perp,
\end{aligned}
\end{equation}
where \( \BB = B \Bcap \).

A multivector integration factor method for solving the Lorentz force equation in constant external electric and magnetic fields can be found in \citep{hestenes1999nfc}.  Other examples, solved using a relativistic formulation of GA, can be found in \citep{doran2003gap},
\citep{hestenes1974properdynamics}, and
\citep{hestenes1974propermechanics}.

\subsubsection{Problems.}
\makeproblem{Constant magnetic field.}{problem:lorentzForce_constantMagnetic:240}{
In \cref{eqn:lorentzForce_constantMagnetic:220}, each of
\( \lr{ \Bv(0) \cdot \hat{\Omega} } \hat{\Omega}^{-1} \), \( \lr{ \Bv(0) \wedge \hat{\Omega} } \hat{\Omega}^{-1} \), and
\( \Bv(0)_\parallel e^{\Omega t} + \Bv(0)_\perp \), was expanded by setting \( \hat{\Omega} = I \Bcap \).  Perform those calculations.
} % problem
